<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- –®—Ä–∏—Ñ—Ç—ã -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- –ù–∞—à–∏ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <title>Everist - –ö–æ—Ä–∑–∏–Ω–∞</title>
    <link rel="icon" type="image/png" href="../img/logo1.png">
    
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã */
        .cart-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }
        
        .cart-header {
            margin-bottom: 40px;
        }
        
        .cart-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #000;
        }
        
        .cart-subtitle {
            font-size: 16px;
            color: #666;
        }
        
        .cart-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
        }
        
        @media (max-width: 992px) {
            .cart-content {
                grid-template-columns: 1fr;
            }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ */
        .cart-items {
            background: white;
            border: 1px solid #eee;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .cart-item {
            display: grid;
            grid-template-columns: 120px 2fr 1fr 1fr auto;
            gap: 20px;
            padding: 25px;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-image {
            width: 120px;
            height: 120px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cart-item-info {
            padding-right: 20px;
        }
        
        .cart-item-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #000;
        }
        
        .cart-item-category {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .cart-item-features {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        .feature-tag {
            background: #f5f5f5;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            color: #666;
        }
        
        .cart-item-price {
            font-size: 20px;
            font-weight: 700;
            color: #000;
            text-align: center;
        }
        
        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }
        
        .quantity-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quantity-btn:hover {
            background: #f5f5f5;
        }
        
        .quantity-input {
            width: 50px;
            height: 32px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 16px;
        }
        
        .cart-item-remove {
            background: none;
            border: none;
            color: #ff4444;
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            opacity: 0.6;
            transition: opacity 0.3s;
        }
        
        .cart-item-remove:hover {
            opacity: 1;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏—Ç–æ–≥–æ–≤ */
        .cart-summary {
            background: white;
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 30px;
            position: sticky;
            top: 100px;
            height: fit-content;
        }
        
        .summary-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            color: #000;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .summary-label {
            color: #666;
        }
        
        .summary-value {
            font-weight: 500;
            color: #000;
        }
        
        .summary-total {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px solid #eee;
            font-size: 20px;
            font-weight: 700;
            color: #000;
        }
        
        .summary-total .summary-value {
            font-size: 24px;
        }
        
        .checkout-button {
            width: 100%;
            background: #000;
            color: white;
            border: none;
            padding: 16px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .checkout-button:hover {
            background: #333;
        }
        
        .checkout-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .cart-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-button {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-button:hover {
            background: #f5f5f5;
            border-color: #000;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—É—Å—Ç–æ–π –∫–æ—Ä–∑–∏–Ω—ã */
        .empty-cart {
            text-align: center;
            padding: 80px 20px;
        }
        
        .empty-cart-icon {
            font-size: 80px;
            color: #eee;
            margin-bottom: 30px;
        }
        
        .empty-cart h2 {
            font-size: 28px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .empty-cart p {
            font-size: 16px;
            color: #666;
            margin-bottom: 30px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 9999;
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 300px;
            display: none;
        }
        
        .notification.show {
            display: block;
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification-content i {
            font-size: 18px;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .cart-item {
                grid-template-columns: 100px 1fr;
                grid-template-rows: auto auto auto;
                gap: 15px;
            }
            
            .cart-item-image {
                grid-row: 1 / 3;
                width: 100px;
                height: 100px;
            }
            
            .cart-item-price {
                grid-column: 2;
                text-align: left;
            }
            
            .cart-item-quantity {
                grid-column: 2;
                justify-content: flex-start;
            }
            
            .cart-item-remove {
                grid-column: 2;
                justify-self: flex-end;
                margin-top: -40px;
            }
            
            .cart-actions {
                flex-direction: column;
            }
        }
        
        @media (max-width: 480px) {
            .cart-container {
                padding: 0 15px;
            }
            
            .cart-item {
                padding: 15px;
            }
            
            .cart-summary {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <a href="../index.html" class="logo">EVERIST</a>
        <nav class="nav-links">
            <a href="shop.html">SHOP</a>
            <a href="../index.html">LEARN</a>
            <a href="#">SUSTAINABILITY</a>
            <a href="#">OUR STORY</a>
            <a href="#">PRESS</a>
        </nav>
        <div class="header-right" id="headerRight">
            <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–æ–º -->
        </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main>
        <div class="cart-container">
            <div class="cart-header">
                <h1 class="cart-title">–ö–æ—Ä–∑–∏–Ω–∞</h1>
                <p class="cart-subtitle">–í–∞—à–∏ —ç–∫–æ–ª–æ–≥–∏—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏</p>
            </div>
            
            <div class="cart-content" id="cartContent">
                <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–æ–º -->
            </div>
        </div>
    </main>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <i class="fas fa-check-circle"></i>
            <span id="notificationMessage"></span>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="../js/data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            await initializeCart();
        });
        
        let cartItems = [];
        
        async function initializeCart() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            const currentUser = window.dataService?.getCurrentUser();
            
            if (!currentUser) {
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ—Ä–∑–∏–Ω—É');
                window.location.href = 'login.html';
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º header
            updateHeader(currentUser);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
            await loadCart(currentUser.id);
        }
        
        function updateHeader(user) {
            const headerRight = document.getElementById('headerRight');
            if (!headerRight) return;
            
            const cartCount = window.dataService.getCartItemCount(user.id);
            
            headerRight.innerHTML = `
                <a href="#" class="search-icon">üîç</a>
                <a href="profile.html" class="user-icon" title="${user.email}">
                    ${user.name.split(' ')[0] || user.email}
                </a>
                <a href="cart.html" class="cart-icon">
                    üõí
                    <span class="cart-badge" style="${cartCount > 0 ? 'display: flex' : 'display: none'}">
                        ${cartCount}
                    </span>
                </a>
            `;
        }
        
        async function loadCart(userId) {
            try {
                cartItems = window.dataService.getCartItems(userId);
                renderCart();
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã:', error);
                showEmptyCart();
            }
        }
        
        function renderCart() {
            const cartContent = document.getElementById('cartContent');
            if (!cartContent) return;
            
            if (cartItems.length === 0) {
                showEmptyCart();
                return;
            }
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏—Ç–æ–≥–∏
            const subtotal = cartItems.reduce((sum, item) => {
                return sum + (item.product ? item.product.price * item.quantity : 0);
            }, 0);
            
            const shipping = subtotal > 50 ? 0 : 5.99; // –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç $50
            const tax = subtotal * 0.1; // 10% –Ω–∞–ª–æ–≥
            const total = subtotal + shipping + tax;
            
            // –†–µ–Ω–¥–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
            const cartItemsHTML = cartItems.map(item => {
                if (!item.product) return '';
                
                return `
                    <div class="cart-item" data-product-id="${item.productId}">
                        <div class="cart-item-image">
                            <img src="${item.product.image}" 
                                 alt="${item.product.name}"
                                 onerror="this.src='../img/placeholder.jpg'">
                        </div>
                        
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.product.name}</div>
                            <div class="cart-item-category">
                                ${getCategoryName(item.product.category)}
                            </div>
                            <div class="cart-item-features">
                                ${item.product.features.slice(0, 2).map(feature => `
                                    <span class="feature-tag">${feature}</span>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="cart-item-price">
                            $${item.product.price.toFixed(2)}
                        </div>
                        
                        <div class="cart-item-quantity">
                            <button class="quantity-btn" 
                                    onclick="updateQuantity(${item.productId}, ${item.quantity - 1})">
                                -
                            </button>
                            <input type="text" 
                                   class="quantity-input" 
                                   value="${item.quantity}"
                                   onchange="updateQuantity(${item.productId}, parseInt(this.value))">
                            <button class="quantity-btn" 
                                    onclick="updateQuantity(${item.productId}, ${item.quantity + 1})">
                                +
                            </button>
                        </div>
                        
                        <button class="cart-item-remove" 
                                onclick="removeFromCart(${item.productId})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
            }).join('');
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –∏—Ç–æ–≥–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            const summaryHTML = `
                <div class="cart-summary">
                    <h3 class="summary-title">–ò—Ç–æ–≥ –∑–∞–∫–∞–∑–∞</h3>
                    
                    <div class="summary-row">
                        <span class="summary-label">–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∏—Ç–æ–≥</span>
                        <span class="summary-value">$${subtotal.toFixed(2)}</span>
                    </div>
                    
                    <div class="summary-row">
                        <span class="summary-label">–î–æ—Å—Ç–∞–≤–∫–∞</span>
                        <span class="summary-value">
                            ${shipping === 0 ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : `$${shipping.toFixed(2)}`}
                        </span>
                    </div>
                    
                    <div class="summary-row">
                        <span class="summary-label">–ù–∞–ª–æ–≥ (10%)</span>
                        <span class="summary-value">$${tax.toFixed(2)}</span>
                    </div>
                    
                    <div class="summary-row summary-total">
                        <span class="summary-label">–ò—Ç–æ–≥–æ</span>
                        <span class="summary-value">$${total.toFixed(2)}</span>
                    </div>
                    
                    <button class="checkout-button" onclick="checkout()">
                        <i class="fas fa-lock"></i> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                    </button>
                    
                    <div class="cart-actions">
                        <button class="action-button" onclick="continueShopping()">
                            <i class="fas fa-arrow-left"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
                        </button>
                        <button class="action-button" onclick="clearCart()">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
                        </button>
                    </div>
                </div>
            `;
            
            // –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ
            cartContent.innerHTML = `
                <div class="cart-items">
                    ${cartItemsHTML}
                </div>
                ${summaryHTML}
            `;
        }
        
        function showEmptyCart() {
            const cartContent = document.getElementById('cartContent');
            if (!cartContent) return;
            
            cartContent.innerHTML = `
                <div class="empty-cart">
                    <div class="empty-cart-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <h2>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h2>
                    <p>–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –Ω–∞—à–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</p>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <a href="shop.html" class="btn btn-primary">
                            <i class="fas fa-shopping-bag"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω
                        </a>
                        <a href="../index.html" class="btn btn-outline">
                            <i class="fas fa-home"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
                        </a>
                    </div>
                </div>
            `;
        }
        
        async function updateQuantity(productId, newQuantity) {
            const currentUser = window.dataService?.getCurrentUser();
            if (!currentUser) return;
            
            try {
                if (newQuantity < 1) {
                    await window.dataService.removeFromCart(currentUser.id, productId);
                    showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
                } else {
                    await window.dataService.updateCartItemQuantity(currentUser.id, productId, newQuantity);
                    showNotification('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ');
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É
                await loadCart(currentUser.id);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–π–¥–∂ –≤ header
                window.dataService.updateCartBadge();
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞:', error);
                showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞', 'error');
            }
        }
        
        async function removeFromCart(productId) {
            const currentUser = window.dataService?.getCurrentUser();
            if (!currentUser) return;
            
            if (confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã?')) {
                try {
                    await window.dataService.removeFromCart(currentUser.id, productId);
                    showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É
                    await loadCart(currentUser.id);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–π–¥–∂ –≤ header
                    window.dataService.updateCartBadge();
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:', error);
                    showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞', 'error');
                }
            }
        }
        
        async function clearCart() {
            const currentUser = window.dataService?.getCurrentUser();
            if (!currentUser) return;
            
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∫–æ—Ä–∑–∏–Ω—É?')) {
                try {
                    await window.dataService.clearCart(currentUser.id);
                    showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –æ—á–∏—â–µ–Ω–∞');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É
                    await loadCart(currentUser.id);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–π–¥–∂ –≤ header
                    window.dataService.updateCartBadge();
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã:', error);
                    showNotification('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã', 'error');
                }
            }
        }
        
        function continueShopping() {
            window.location.href = 'shop.html';
        }
        
        function checkout() {
            const currentUser = window.dataService?.getCurrentUser();
            if (!currentUser || cartItems.length === 0) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏
            if (!currentUser.address) {
                if (confirm('–£ –≤–∞—Å –Ω–µ —É–∫–∞–∑–∞–Ω –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏. –•–æ—Ç–∏—Ç–µ —É–∫–∞–∑–∞—Ç—å –µ–≥–æ —Å–µ–π—á–∞—Å?')) {
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –∞–¥—Ä–µ—Å–∞
                    const address = prompt('–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:');
                    if (address) {
                        try {
                            window.dataService.updateUserProfile(currentUser.id, { address });
                            showNotification('–ê–¥—Ä–µ—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω');
                        } catch (error) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞:', error);
                        }
                    }
                } else {
                    return;
                }
            }
            
            // –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
            try {
                const order = window.dataService.createOrder(currentUser.id, currentUser.address);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                alert(`–ó–∞–∫–∞–∑ #${order.id} —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n\n–°—É–º–º–∞: $${order.total.toFixed(2)}\n–°—Ç–∞—Ç—É—Å: ${getStatusText(order.status)}\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!`);
                
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ –ø—Ä–æ—Ñ–∏–ª—å
                window.location.href = 'profile.html';
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞:', error);
                alert('–û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞: ' + error.message);
            }
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const messageEl = document.getElementById('notificationMessage');
            
            if (!notification || !messageEl) return;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å—Ç–∏–ª—å
            messageEl.textContent = message;
            
            if (type === 'error') {
                notification.style.background = '#f44336';
            } else {
                notification.style.background = '#4CAF50';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            notification.classList.add('show');
            
            // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function getCategoryName(category) {
            const categories = {
                'hair': '–î–ª—è –≤–æ–ª–æ—Å',
                'face': '–î–ª—è –ª–∏—Ü–∞',
                'body': '–î–ª—è —Ç–µ–ª–∞',
                'kit': '–ù–∞–±–æ—Ä—ã',
                'oral': '–£—Ö–æ–¥ –∑–∞ –ø–æ–ª–æ—Å—Ç—å—é —Ä—Ç–∞',
                'home': '–î–ª—è –¥–æ–º–∞',
                'perfume': '–ê—Ä–æ–º–∞—Ç—ã'
            };
            return categories[category] || category;
        }
        
        function getStatusText(status) {
            const statuses = {
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω',
                'pending': '–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã',
                'processing': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ'
            };
            return statuses[status] || status;
        }
    </script>
</body>
</html>